:toc: left
:toclevels: 5
:sectnums:
:stem:
:source-highlighter: coderay

= æ–°ã—ã„Axon Frameworkãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«ã€APIå®šç¾©ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å«ã‚€ `core-api` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã€ãƒã‚¤ã‚¯ãƒ¬ãƒ³ã‚¿ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å«ã‚€ `rental` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®2ã¤ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ãªã‚‹ãƒãƒ«ãƒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«Gradleãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

== ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

ãƒ¬ãƒ³ã‚¿ãƒ«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ *ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ãƒ¢ãƒãƒªã‚¹* ã¨ã—ã¦è¨­è¨ˆã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’1ã¤ã«ã¾ã¨ã‚ã€å¾Œã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç•°ãªã‚‹éƒ¨åˆ†ã«åˆ†å‰²ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã«ã€ãƒ­ã‚¸ãƒƒã‚¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ†é›¢ã—ã¦ä¿æŒã—ã¾ã™ã€‚
ã¾ãšã€æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€ãƒ“ã‚¸ãƒã‚¹ã‚³ãƒ¼ãƒ‰ã«é›†ä¸­ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®Spring Bootã¨Axon Frameworkã®ä¾å­˜é–¢ä¿‚ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
æ¬¡ã®æ§‹é€ ã‚’æŒã¤Gradleãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ï¼š

[listing]
.ãƒã‚¤ã‚¯ãƒ¬ãƒ³ã‚¿ãƒ«ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹é€ 
----
ğŸ“‚ app
  ğŸ“‚ bike-rental
    ğŸ“‚	core-api
      ğŸ“‚ src
        ğŸ“‚ main
          ğŸ“‚ java
             ğŸ“¦ io.axoniq.demo.bikerental.coreapi
      ğŸ“„ build.gradle.kts
    ğŸ“‚ rental
      ğŸ“‚ src
        ğŸ“‚ main
          ğŸ“‚ java
             ğŸ“¦ io.axoniq.demo.bikerental.rental
      ğŸ“„ build.gradle.kts
    ğŸ“„ settings.gradle.kts
    ğŸ“„ build.gradle.kts
----

== ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

ã¾ãšã€æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ï¼š

[source,shell]
----
mkdir -p app/backend/bike-rental
cd app/backend/bike-rental
gradle init

Select type of build to generate:
  1: Application
  2: Library
  3: Gradle plugin
  4: Basic (build structure only)
Enter selection (default: Application) [1..4]

Select implementation language:
  1: Java
  2: Kotlin
  3: Groovy
  4: Scala
  5: C++
  6: Swift
Enter selection (default: Java) [1..6]

Enter target Java version (min: 7, default: 21):

Project name (default: bike-rental):

Select application structure:
  1: Single application project
  2: Application and library project
Enter selection (default: Single application project) [1..2] 2

Select build script DSL:
  1: Kotlin
  2: Groovy
Enter selection (default: Kotlin) [1..2]

Generate build using new APIs and behavior (some features may change in the next minor release)? (default: no) [yes, no]
----

ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä½œæˆã•ã‚Œã‚‹ã®ã§ã€`core-api` ã¨ `rental` ã®2ã¤ã®ã‚µãƒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿½åŠ ã—ã¦ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

[source,shell]
----
spring init --package-name=io.axoniq.demo.bikerental.coreapi core-api
spring init --package-name=io.axoniq.demo.bikerental.rental rental
----

== ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š

ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®`settings.gradle.kts`ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ï¼š
[source,kotlin]
----
rootProject.name = "bike-rental"
include("core-api", "rental")
----

ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `build.gradle.kts` ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ï¼š
[source,kotlin]
----
plugins {
    java
}

allprojects {
    apply(plugin = "java")
    apply(plugin = "buildlogic.java-application-conventions")
    apply(plugin = "buildlogic.java-common-conventions")
    apply(plugin = "buildlogic.java-library-conventions")
}

subprojects {
    group = "io.axoniq.demo.bikerental"

    repositories {
        mavenCentral()
    }

    dependencies {
        testRuntimeOnly("org.junit.platform:junit-platform-launcher")
    }
}
----

== å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è¨­å®š
`core-api` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® `settings.gradle` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¦ `build.gradle` ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ `build.gradle.kts` ã«å¤‰æ›´ã—ã¾ã™ã€‚
`core-api` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® `build.gradle.kts` ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ï¼š

[source,kotlin]
----
plugins {
	id("org.springframework.boot") version "3.4.0"
	id("io.spring.dependency-management") version "1.1.6"
}

version = "0.0.1-SNAPSHOT"

java {
	toolchain {
		languageVersion.set(JavaLanguageVersion.of(21))
	}
}

dependencies {
	implementation("org.springframework.boot:spring-boot-starter")
	testImplementation("org.springframework.boot:spring-boot-starter-test")
}

tasks.named<Test>("test") {
	useJUnitPlatform()
}

tasks.withType<JavaCompile>().configureEach {
	options.compilerArgs.add("-parameters")
}
----

`rental` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® `settings.gradle` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¦ `build.gradle` ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ `build.gradle.kts` ã«å¤‰æ›´ã—ã¾ã™ã€‚
`rental` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® `build.gradle.kts` ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ï¼š

[source,kotlin]
----
plugins {
	id("org.springframework.boot") version "3.4.0"
	id("io.spring.dependency-management") version "1.1.6"
}

version = "0.0.1-SNAPSHOT"

java {
	toolchain {
		languageVersion.set(JavaLanguageVersion.of(21))
	}
}

dependencies {
	implementation("org.springframework.boot:spring-boot-starter")
	testImplementation("org.springframework.boot:spring-boot-starter-test")
	api(project(":core-api"))
}

tasks.named<Test>("test") {
	useJUnitPlatform()
}
----

`app` `list` `utilites` ã¯ä¸è¦ãªã®ã§å‰Šé™¤ã—ã¾ã™ã€‚

IDEã¯æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ã¯ãšã§ã™ã€‚

NOTE: IDEãŒæ–°ã—ã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¤œå‡ºã—ãªã„å ´åˆã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’æ›´æ–°ã—ã€IDEã®Gradleãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å†èª­ã¿è¾¼ã¿ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚ŒãŸã‚‰ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§Axon Frameworkã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚